<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HYPE Funding Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body { background: #0b1221; color: #e8eefc; }
      .card { background: #121a2a; border: 1px solid #1f2a44; }
      .accent { color: #6fddff; }
      .positive { color: #00e676; }
      .negative { color: #ff5252; }
      .muted { color: #a9b4cc; }
    </style>
  </head>
  <body>
    <div class="container py-4">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="m-0">HYPE Funding Dashboard</h2>
        <span class="muted">Coin: {{ coin }}</span>
      </div>

      <div class="row g-4">
        <div class="col-md-4">
          <div class="card p-3 h-100">
            <h5 class="mb-3">Current Funding (HL)</h5>
            {% if hl_current %}
            <div>Funding: <span class="accent">{{ '%.6f'|format(hl_current.get('funding', 0.0)) }}</span></div>
            <div>Premium: <span class="accent">{{ '%.6f'|format(hl_current.get('premium', 0.0)) }}</span></div>
            <div>Mark: <span class="accent">{{ hl_current.get('markPx', '-') }}</span></div>
            <div>Oracle: <span class="accent">{{ hl_current.get('oraclePx', '-') }}</span></div>
            <div>Open Interest: <span class="accent">{{ '%.2f'|format(hl_current.get('openInterest', 0.0)) }}</span></div>
            {% else %}
            <div class="muted">No current data</div>
            {% endif %}
          </div>
        </div>

        <div class="col-md-4">
          <div class="card p-3 h-100">
            <h5 class="mb-3">Next Hour Prediction</h5>
            {% if prediction and prediction.get('direction') %}
            <div>Direction:
              {% if prediction.get('direction') == 'positive' %}
                <span class="positive">Positive</span>
              {% else %}
                <span class="negative">Negative</span>
              {% endif %}
            </div>
            <div>Prob Positive: <span class="accent">{{ '%.4f'|format(prediction.get('prob_positive', 0.0)) }}</span></div>
            <div>Confidence: <span class="accent">{{ '%.4f'|format(prediction.get('confidence', 0.0)) }}</span></div>
            <div>Models: <span class="muted">{{ prediction.get('n_models', '-') }}</span></div>
            {% else %}
            <div class="muted">Prediction not available</div>
            {% endif %}
            <hr/>
            <h6 class="mb-2">HL Predicted Funding</h6>
            {% if hl_pred %}
              <div>Funding Rate: <span class="accent">{{ hl_pred.get('fundingRate', '-') }}</span></div>
              <div>Next Funding Time: <span class="muted">{{ hl_pred.get('nextFundingTime', '-') }}</span></div>
            {% else %}
              <div class="muted">No predicted funding available</div>
            {% endif %}
          </div>
        </div>

        <div class="col-md-4">
          <div class="card p-3 h-100">
            <h5 class="mb-3">Prediction vs Actual</h5>
            {% if comparison and comparison.get('predicted_direction') %}
              <div>Predicted: 
                {% if comparison.get('predicted_direction') == 'positive' %}
                  <span class="positive">Positive</span>
                {% else %}
                  <span class="negative">Negative</span>
                {% endif %}
              </div>
              <div>Prob Positive: <span class="accent">{{ '%.4f'|format(comparison.get('prob_positive', 0.0)) }}</span></div>
              <div>Realized: 
                {% if comparison.get('realized_direction') == 'positive' %}
                  <span class="positive">Positive</span>
                {% else %}
                  <span class="negative">Negative</span>
                {% endif %}
              </div>
              <div>Correct: <span class="accent">{{ comparison.get('correct', '-') }}</span></div>
              <div class="muted">At: {{ comparison.get('last_prediction_time', '-') }}</div>
            {% else %}
              <div class="muted">Not enough data yet to compare</div>
            {% endif %}
          </div>
        </div>
      </div>

      <div class="text-end mt-4">
        <a class="btn btn-outline-info" href="/api/status">API JSON</a>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html> 